import{a as e,L as v,h as c,b as I,_ as d,u as w,c as M,d as H,y as p,i as E}from"../../assets/main-M1JXPXYr.js";import{a as b,u as y,J as f,w as $,F as u,h as N,b as j,e as F,f as R,g as T,c as P,l as k,L as V,S as x,o as _,i as g}from"../../assets/FormError-vi6V5DhB.js";const G=({title:s})=>e("h2",{className:"mb-8 flex items-center justify-center gap-4 text-center text-2xl font-bold",children:[e(v,{}),s]}),q=/^(https?:\/\/)?([a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)+)(:[0-9]{1,5})?(\/.*)?$/,B=()=>{const[s,t]=c(!1),{links:a,queryLinks:o}=b(),{instanceUrl:n,setInstanceUrl:l,password:i,setPassword:L,updateStorage:z}=y(),[m,h]=c({}),C=r=>l(r.target.value),S=r=>L(r.target.value),A=()=>{const r={};return n?q.test(n)||(r.instanceUrl="实例 URL 无效"):r.instanceUrl="必须填写实例 URL",i||(r.password="必须填写密码"),h(r),Object.keys(r).length===0},U=r=>{r.preventDefault(),A()&&(t(!0),z().then(()=>o(100,()=>{h({login:"失败！请核查你填写的网址和密码是否正确"})})).finally(()=>t(!1)))};return I(()=>{h({})},[n,i]),e("div",{className:"w-[450px] rounded-lg bg-white p-8",children:[e(G,{title:"设置"}),e("div",{className:"space-y-4",children:[e("div",{children:[e("label",{htmlFor:"instanceUrl",className:"flex justify-between text-sm font-medium text-gray-700",children:["你部署的Sink网址",e(f,{link:a?`${n}/dashboard/links`:"",svg:$,alt:"前往我的 Sink"})]}),e("input",{id:"instanceUrl",type:"text",placeholder:"示例：https://example.com",value:n,onInput:C,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-800 focus:outline-none focus:ring-gray-800 sm:text-sm"}),e(u,{error:m.instanceUrl})]}),e("div",{children:[e("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"密码"}),e("input",{id:"password",type:"password",placeholder:"站点令牌",value:i,onInput:S,className:"mt-1 block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-gray-800 focus:outline-none focus:ring-gray-800 sm:text-sm"})]}),e(u,{error:m.password}),e(u,{error:m.login}),e("button",{type:"submit",disabled:s,className:`${a?"w-30":"w-full"} mt-8 rounded-md border border-transparent bg-gray-800 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-gray-900 focus:outline-none focus:ring-2 focus:ring-gray-800 focus:ring-offset-2`,onClick:U,children:s?"登录中...":a?"更新":"登录"})]}),e(N,{hideSetting:!0,hideWeb:!0})]})},O=s=>d("svg",{t:1724171247230,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2064,width:200,height:200,...s},d("path",{fill:"currentColor",d:"M149.312 202.688h725.376c5.888 0 10.624 4.736 10.624 10.624V640a10.688 10.688 0 0 1-10.624 10.688H149.312A10.688 10.688 0 0 1 138.688 640V213.312c0-5.888 4.736-10.624 10.624-10.624z m501.376 512h224c41.216 0 74.624-33.472 74.624-74.688V213.312c0-41.216-33.408-74.624-74.624-74.624H149.312c-41.216 0-74.624 33.408-74.624 74.624V640c0 41.216 33.408 74.688 74.624 74.688h224v128H298.688a32 32 0 1 0 0 64h426.624a32 32 0 0 0 0-64h-74.624v-128z m-64 0v128H437.312v-128h149.376zM437.312 576a32 32 0 0 1 32-32h85.376a32 32 0 0 1 0 64H469.312a32 32 0 0 1-32-32z","p-id":2065})),W=s=>d("svg",{t:1723964719700,className:"icon",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg","p-id":2059,width:200,height:200,...s},d("path",{fill:"currentColor",d:"M53.312 512a458.688 458.688 0 1 1 917.376 0A458.688 458.688 0 0 1 53.312 512z m339.52-376.32a394.048 394.048 0 0 0-138.88 77.632c25.6 22.08 53.952 40.96 84.48 55.936 6.784-25.408 14.528-49.152 23.168-70.848 9.216-22.912 19.584-44.16 31.232-62.72zM209.024 258.944A392.896 392.896 0 0 0 118.592 480h191.232c1.472-51.584 6.528-100.992 14.656-146.688a459.136 459.136 0 0 1-115.456-74.24z m422.144 629.376a394.176 394.176 0 0 0 138.88-77.696 395.328 395.328 0 0 0-84.48-55.936 610.752 610.752 0 0 1-23.168 70.848c-9.152 22.912-19.584 44.096-31.232 62.72z m183.808-123.456A392.832 392.832 0 0 0 905.408 544H714.24a1008.704 1008.704 0 0 1-14.72 146.624c42.24 19.008 81.152 44.16 115.456 74.304zM905.408 480a392.96 392.96 0 0 0-90.432-220.928 459.2 459.2 0 0 1-115.392 74.24c8.064 45.696 13.12 95.104 14.656 146.688h191.168zM769.92 213.312a394.112 394.112 0 0 0-138.88-77.696c11.712 18.688 22.144 39.872 31.296 62.784 8.704 21.76 16.448 45.44 23.104 70.848a395.328 395.328 0 0 0 84.48-55.936zM392.832 888.384a399.04 399.04 0 0 1-31.232-62.784 610.624 610.624 0 0 1-23.104-70.848 395.264 395.264 0 0 0-84.48 55.936 394.048 394.048 0 0 0 138.88 77.696z m-183.744-123.456a459.136 459.136 0 0 1 115.392-74.24A1008.448 1008.448 0 0 1 309.76 544H118.656a392.896 392.896 0 0 0 90.496 220.928zM512 117.312c-11.904 0-26.496 5.952-43.2 23.552-16.64 17.664-33.216 44.928-47.744 81.28-8.448 21.12-16 44.8-22.528 70.656A394.752 394.752 0 0 0 512 309.312c39.488 0 77.568-5.76 113.536-16.512a557.824 557.824 0 0 0-22.528-70.592c-14.592-36.416-31.104-63.68-47.808-81.344-16.64-17.6-31.232-23.552-43.2-23.552zM373.824 480h276.352a953.28 953.28 0 0 0-11.712-124.352A458.88 458.88 0 0 1 512 373.312a458.88 458.88 0 0 1-126.4-17.664A953.216 953.216 0 0 0 373.76 480z m11.776 188.352A458.944 458.944 0 0 1 512 650.688c43.84 0 86.272 6.144 126.464 17.664 6.272-38.656 10.368-80.448 11.712-124.352H373.824c1.344 43.904 5.44 85.76 11.776 124.352zM512 714.688c-39.424 0-77.568 5.76-113.472 16.512 6.464 25.792 14.08 49.472 22.528 70.592 14.528 36.416 31.04 63.68 47.744 81.344 16.64 17.6 31.296 23.552 43.2 23.552 11.968 0 26.56-5.952 43.2-23.552 16.704-17.664 33.28-44.928 47.808-81.28 8.448-21.184 16-44.8 22.464-70.656A394.752 394.752 0 0 0 512 714.688z","p-id":2060})),Y=({isOpen:s,onClose:t,children:a,mask:o=!0,maskClosable:n=!0,showCloseButton:l})=>e("div",{className:`${s?"scale-100 opacity-100":"scale-0 opacity-0"} bg-black ${o?"bg-opacity-50":"bg-opacity-10"} fixed inset-0 z-50 flex flex-col items-center justify-center transition-opacity duration-500`,onClick:n?t:void 0,children:e("div",{className:"scale-100 transform rounded-lg bg-white p-4 shadow-lg transition-transform duration-300",onClick:i=>i.stopPropagation(),children:[l&&e("button",{className:"absolute right-2 top-2 text-gray-500 transition-all hover:text-gray-700",onClick:t,children:"✖"}),a]})}),J=({shortKey:s,url:t})=>{const[a,o]=c(!1),{instanceUrl:n}=y(),l=()=>{o(!0),P(`${n}/${s}`,()=>{setTimeout(()=>o(!1),2e3)})},i=j(t);return e("div",{className:"bg-white mt-2 rounded-lg border shadow-lg transition-transform hover:scale-105",children:e("div",{className:"flex flex-col space-y-3 p-4",children:e("div",{className:"flex items-center justify-center space-x-3",children:[e("span",{className:"text-foreground bg-secondary inline-flex h-10 w-10 shrink-0 select-none items-center justify-center overflow-hidden rounded-full text-xs font-normal",children:e(F,{className:"overflow-hidden rounded-full",src:i,alt:s})}),e("div",{className:"w-[250px] flex-1 overflow-hidden",children:[e("div",{className:"flex items-center",children:[e("div",{className:"mr-1 truncate text-base font-bold leading-5",children:s}),a?e(R,{className:"ml-1 shrink-0 w-5 h-5 text-green-500"}):e(T,{onClick:l,className:"ml-1 shrink-0 cursor-pointer w-5 h-5",alt:"复制短链接"})]}),e("div",{className:"line-clamp-1 w-full overflow-hidden text-sm text-gray-500",alt:t,children:t})]}),e(f,{link:t})]})})})},Z=()=>{const s=w(k);return e("div",{children:s?e(M,{children:[e("div",{className:"grid grid-cols-[repeat(auto-fit,minmax(300px,1fr))] gap-4",children:s.map(t=>e(J,{url:t.url,shortKey:t.slug},t.slug))}),e("div",{className:"mb-4 mt-8 text-center text-gray-400",children:s.length===0?"未找到链接":"没有更多链接"})]}):"未找到链接"})},D=()=>{const[s,t]=H(_),a=w(k),[o,n]=c(void 0),{isRefreshing:l}=b();return p(()=>{},[s]),p(()=>{chrome.storage.local.get(g.KEY,i=>{n(i[g.KEY][g.INSTANCE_URL])})},[s]),e("div",{className:"flex h-screen w-screen justify-center overflow-y-auto bg-gray-100 p-8",children:[e(Y,{isOpen:!s,onClose:()=>a&&t(!0),mask:!1,maskClosable:!!a,showCloseButton:!!a,children:e(B,{})}),e("div",{className:"m-5 flex max-w-7xl flex-1 flex-col",children:[e("h2",{className:"flex items-center justify-start gap-4 text-center text-2xl font-bold",children:[e(v,{}),"当前在用链接",l&&e(V,{}),a&&e("div",{className:"ml-auto flex items-center",children:[o&&e(f,{link:`${o}/dashboard/links`,children:e(W,{className:"mr-2 h-9 w-9 cursor-pointer text-gray-600"})}),e(O,{className:"h-10 w-10 cursor-pointer text-green-500 hover:opacity-80",onClick:()=>t(!1)})]})]}),e(x,{}),e(Z,{}),e(x,{}),e(N,{hideSetting:!0,hideWeb:!0,hideGift:!0})]})]})};E(e(D,{}));
